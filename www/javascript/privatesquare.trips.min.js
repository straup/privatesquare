function privatesquare_trips_datepicker_init(){$("#arrival").datepicker({language:"en"});$("#departure").datepicker({language:"en"})}function privatesquare_trips_select2_init(){$("#where").select2({minimumInputLength:3,ajax:{url:"http://privatesquare/user_trips_add_geocode.php",dataType:"json",data:function(a){return{q:a}},results:function(a){return{results:a.results}}}})}
function privatesquare_trips_gather_trip_info(){var a=$("#where").val(),b=$("#arrival").val(),c=$("#departure").val(),d=$("#arrive_by").val(),e=$("#depart_by").val(),f=$("#status_id").val(),g=$("#note").val();a={woeid:a,arrival:b,departure:c,arrive_by:d,depart_by:e,status_id:f,note:g};if(trip=$("#trip"))a.id=trip.val();return a}
function privatesquare_trips_add_init(){privatesquare_trips_datepicker_init();privatesquare_trips_select2_init();$("#add-trip").submit(function(){var a=$("#add-trip").attr("data-add-trip-crumb"),b=privatesquare_trips_gather_trip_info();b.crumb=a;a=$("#select2-chosen-1").html();privatesquare_api_call("privatesquare.trips.addTrip",b,_privatesquare_trips_add_trip_onsuccess);privatesquare_set_status("Adding trip to "+htmlspecialchars(a));return false})}
function _privatesquare_trips_add_trip_onsuccess(a){if(a.stat!="ok"){privatesquare_set_status(a.error.error,"danger");return false}location.href=a.trip.trip_url+"?success=1"}
function privatesquare_trips_edit_init(){privatesquare_trips_datepicker_init();$("#trip-locality small").click(function(){privatesquare_trips_select2_init()});$("#edit-trip").submit(function(){var a=$("#edit-trip").attr("data-edit-trip-crumb"),b=privatesquare_trips_gather_trip_info();b.crumb=a;privatesquare_api_call("privatesquare.trips.editTrip",b,_privatesquare_trips_edit_trip_onsuccess);privatesquare_set_status("Updating your trip");return false});$("#delete-trip").click(function(){if(!confirm("Are you sure you want to delete this trip?"))return false;
var a=$("#edit-trip").attr("data-delete-trip-crumb");a={id:$("#trip").val(),crumb:a};privatesquare_api_call("privatesquare.trips.deleteTrip",a,_privatesquare_trips_delete_trip_onsuccess);privatesquare_set_status("Deleting your trip");return false})}function _privatesquare_trips_edit_trip_onsuccess(a){if(a.stat!="ok"){privatesquare_set_status(a.error.error,"danger");return false}privatesquare_set_status("Your trip has been updated!")}
function _privatesquare_trips_delete_trip_onsuccess(a){if(a.stat!="ok"){privatesquare_set_status(a.error.error,"danger");return false}a=privatesquare_abs_root_url()+"me/trips/?deleted=1";location.href=a};
